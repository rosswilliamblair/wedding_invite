<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
  <link rel="preload" as="image" href="courti.jpg">
<title>Greek Gift Wedding Puzzle</title>
<style>
/* BODY & BACKGROUND */
body {
  font-family: Arial;
  text-align: center;
  margin: 0;
  padding: 0;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  min-height: 100vh;

  background-image: url("courti.jpg");
  background-size: cover;
  background-position: center;
  background-attachment: fixed;

  position: relative;
}

/* PAGE OVERLAY */
body::before {
  content: "";
  position: fixed;
  top:0; left:0; right:0; bottom:0;
  background: rgba(255,255,255,0.15);
  z-index: -1;
  pointer-events: none;
}

/* CENTRAL CONTAINER */
#central-container {
  background: rgba(255,255,255,0.9);
  padding: 1rem 1.5rem;
  border-radius: 12px;
  display: inline-block;
  max-width: 95vw;
  margin: 1rem auto;
  text-align: center;
  box-shadow: 0 0 15px rgba(0,0,0,0.2);
}

/* BOARD */
#board {
  display: grid;
  grid-template-columns: repeat(8, 1fr);
  grid-template-rows: repeat(8, 1fr);
  border: 2px solid #333;
  margin: 1rem auto;
  width: min(90vw, 480px);
  aspect-ratio: 1/1;
}
.square { width:100%; height:100%; position:relative; }
.light { background:#f0d9b5; }
.dark { background:#b58863; }

/* PIECES */
.piece { width:100%; height:100%; cursor:grab; display:flex; align-items:center; justify-content:center; }
.piece img { width:80%; height:80%; pointer-events:none; }

/* MOVE HIGHLIGHT */
.selected { background: rgba(128,128,128,0.4) !important; }
.correct { box-shadow: 0 0 0 4px green inset; transition: box-shadow 0.5s; }
.wrong { box-shadow: 0 0 0 4px red inset; transition: box-shadow 0.5s; }

/* TEXT & MESSAGES */
#unlock { display:none; margin-top:1rem; font-size:1.2rem; color:green; }
#message { margin-top:0.5rem; font-size:1.2rem; color:red; }
#attempt-counter { margin-top:0.5rem; font-size:1.1rem; color:#333; }
#grade-message {
  font-size: 1.1rem;       /* same as moves */
  color: #000;
  text-align: center;
  margin: 0.5rem 0;        /* spacing above and below */
  line-height: 1.4;        /* consistent spacing */
}

#grade-message .grade-letter {
  font-weight: bold;
}

#grade-message .grade-text {
  font-weight: normal;
  display: block;
  margin-top: 0.3rem;      /* space below the letter line */
}

/* BUTTON */
#wedding-link {
  margin-top:1rem;
  padding:0.5rem 1rem;
  font-size:1rem;
  border-radius:6px;
  border:none;
  background: #4CAF50;
  color:white;
  cursor:not-allowed;
  opacity:0.6;
  transition: background 0.3s, opacity 0.3s;
}

#wedding-link.enabled {
  cursor:pointer;
  opacity:1;
  background: #28a745;
}

/* Mobile scaling */
@media (max-width: 768px) {
  #board {
    width: 98vmin;
    height: 98vmin;
    max-width: none;
    max-height: none;
  }

  #central-container {
    padding: 0.5rem;
  }
}
</style>
</head>
<body>

<img src="courti.jpg" alt="" style="display:none;">

<div id="central-container">
  <h2>White to move: Checkmate the black king!</h2>
  <p>Drag your pieces or tap to move them. The correct move reveals the wedding password!</p>

  <div id="board"></div>

  <div id="unlock">
    ðŸŽ‰ Congratulations! The RSVP password is: <strong>corfu2k26</strong>
  </div>

  <div id="message"></div>
  <div id="attempt-counter">Moves: 0</div>
  <div id="grade-message"></div>

  <button id="wedding-link" disabled>Go to Wedding Website</button>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {

const board = document.getElementById("board");

// --- Attempt counter ---
let attempts = 0;
const counterDiv = document.getElementById("attempt-counter");
const gradeDiv = document.getElementById("grade-message");

// --- Grade messages ---
const gradeMessages = {
  "A*": "Legendary! Top table, champagne flowing, prepare your speech.",
  "A": "Primetime! Table 3. Party central without even tryingâ€”well played.",
  "B": "Meh. Table 9. Near the bathrooms. Donâ€™t drop your napkin.",
  "C": "Ouch. Table 36. Youâ€™ll be seated in the chicken coupâ€”bring binoculars.",
  "D": "Seriously? Table 82. You get one bread roll and a chair that wobbles.",
  "E": "Table 145. You might as well be invisible. Or a dying houseplant.",
  "F": "Table 235. Youâ€™re in the next town over, weâ€™ll Deliveroo your dinner.",
  "U": "Weâ€™ve put you in the broom cupboard. Bring a sleeping bag."
};

// --- Create 8x8 board ---
for(let r=8;r>=1;r--){
  for(let c=0;c<8;c++){
    const sq = document.createElement("div");
    sq.className = "square " + ((r+c)%2===0 ? "light":"dark");
    sq.dataset.square = String.fromCharCode(97+c)+r;
    board.appendChild(sq);
  }
}

// --- Initial piece positions ---
const initialPositions = [
  ["d3","bishop_white"],["b4","queen_white"],["b1","king_white"],["h2","rook_white"],
  ["a2","pawn_white"],["b2","pawn_white"],["c2","pawn_white"],["c1","rook_white"],
  ["g8","king_black"],["f8","rook_black"],["f7","pawn_black"],["g7","pawn_black"],["h7","pawn_black"],
  ["h8","knight_black"],["d8","knight_white"]
];

// --- Add pieces ---
function addPiece(square,type){
  const sq = [...board.children].find(s => s.dataset.square===square);
  const pieceDiv = document.createElement("div");
  pieceDiv.className="piece";
  pieceDiv.draggable = true;
  pieceDiv.dataset.type = type;
  const img = document.createElement("img");
  img.src = type + ".png";
  pieceDiv.appendChild(img);
  sq.appendChild(pieceDiv);
}

// --- Reset board ---
function setupPieces(){
  [...board.children].forEach(sq => sq.innerHTML="");
  initialPositions.forEach(pos => addPiece(pos[0],pos[1]));
  document.getElementById("unlock").style.display="none";
  document.getElementById("message").textContent="";
  gradeDiv.textContent = "";
  const btn = document.getElementById("wedding-link");
  btn.disabled = true;
  btn.classList.remove("enabled");
}

setupPieces();

// ---- DRAG & DROP ----
let dragged = null;

document.addEventListener("dragstart", e=>{
  if(e.target.classList.contains("piece")) dragged = e.target;
});

document.addEventListener("dragover", e=>{
  if(e.target.classList.contains("square") || e.target.closest(".square")) e.preventDefault();
});

document.addEventListener("drop", e=>{
  let target = e.target.closest(".square");
  if(target && dragged){
    e.preventDefault();
    target.innerHTML="";
    target.appendChild(dragged);
    checkMove(dragged,target);
    dragged = null;
  }
});

// ---- CLICK TO MOVE ----
let selectedSquare = null;

[...board.children].forEach(square => {
  square.addEventListener("click", () => {
    if(selectedSquare === null){
      if(square.querySelector(".piece")){
        selectedSquare = square;
        square.classList.add("selected");
      }
    } else if(selectedSquare === square){
      selectedSquare.classList.remove("selected");
      selectedSquare = null;
    } else {
      const movingPiece = selectedSquare.querySelector(".piece");
      if(movingPiece){
        square.innerHTML="";
        square.appendChild(movingPiece);
        checkMove(movingPiece,square);
      }
      selectedSquare.classList.remove("selected");
      selectedSquare = null;
    }
  });
});

// ---- MOVE CHECK ----
function checkMove(piece,target){
  attempts++;
  counterDiv.textContent = "Moves: " + attempts;

  if(piece.dataset.type==="bishop_white" && target.dataset.square==="h7"){
    document.getElementById("unlock").style.display="block";
    target.classList.add("correct");
    document.getElementById("wedding-link").disabled = false;
    document.getElementById("wedding-link").classList.add("enabled");

    // --- Grade ---
    let grade;
    switch(attempts){
      case 1: grade = "A*"; break;
      case 2: grade = "A"; break;
      case 3: grade = "B"; break;
      case 4: grade = "C"; break;
      case 5: grade = "D"; break;
      case 6: grade = "E"; break;
      case 7: grade = "F"; break;
      default: grade = "U"; break;
    }

    gradeDiv.innerHTML = 'Grade: <span class="grade-letter">' + grade + '</span>' +
                         '<span class="grade-text">' + gradeMessages[grade] + '</span>';

    setTimeout(()=>{ target.classList.remove("correct"); },1500);

  } else {
    target.classList.add("wrong");
    const funnyMessages = [
      "Whoops! Resetting the board for you.",
      "Nice imagination, terrible execution!",
      "Wrong move! Donâ€™t worry, even grandmasters fail."
    ];
    document.getElementById("message").textContent = funnyMessages[Math.floor(Math.random()*funnyMessages.length)];
    setTimeout(()=>{
      target.classList.remove("wrong");
      setupPieces();
    },1200);
  }
}

// ---- WEDDING WEBSITE BUTTON ----
const btn = document.getElementById("wedding-link");
btn.addEventListener("click", () => {
  if (!btn.disabled) {
    window.open("https://withjoy.com/aileen-and-ross", "_blank");
  }
});

});
</script>
</body>
</html>
